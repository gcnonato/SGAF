
<script type="text/javascript">
    window.onload = function() {
        
        verifica_paravenda();


        var manter = $("input[name=produtomanter]").val();
        if (manter='undefined') manter=1;
        else manter=0;
        var passo = $("input[name=passo]").val();
        //alert(passo);
        if (passo>2) {
            desabilita_campos();
            if (manter = 'on') {
                valida_produto();
                if (document.forms["form1"].qtd)
                    document.forms["form1"].qtd.focus();
            }
            verifica_incluir();

            
        
        }
        
        tipneg= $("select[name=tiponegociacao]").val();
        if (passo<=2) popula_tipopessoa(tipneg);

        //Verifica se o quiosque usa validade e prateleira
        usaprateleira=$("input[name=usaprateleira]").val();
        controlavalidade=$("input[name=controlavalidade]").val();
        if (usaprateleira==0) {
            $("tr[id=linha_prateleira]").hide();
        } else {
            $("tr[id=linha_prateleira]").show();
        }
        if (controlavalidade==0) {
            $("tr[id=linha_validade]").hide();
        } else {
            $("tr[id=linha_validade]").show();
        }
    };


function atualiza_produtos_cadastro_direto () {
    var paravenda=$("select[name=paravenda]").val();
    var tiponeg=$("select[name=tiponegociacao]").val();
    $.post("entradas_cadastrar_atualiza_produtos.php",{
        paravenda:paravenda,
        tiponegociacao:tiponeg
    },function(valor2){
        //alert(valor2);
        $("select[name=produto").html(valor2);
    });    
}

function seleciona_produto(valor) {
    if(valor.match(/'/)) valor = valor.replace("'","");
    if(valor.match(/!/)) valor = valor.replace("!","");
    if(valor.match(/@/)) valor = valor.replace("@","");
    if(valor.match(/#/)) valor = valor.replace("#","");
    if(valor.match(/$/)) valor = valor.replace("$","");
    if(valor.match(/%/)) valor = valor.replace("%","");
    if(valor.match(/^/)) valor = valor.replace("ˆ","");
    if(valor.match(/&/)) valor = valor.replace("&","");
    if(valor.match(/{/)) valor = valor.replace("{","");
    if(valor.match(/}/)) valor = valor.replace("}","");
    if(valor.match(/|/)) valor = valor.replace("|","");
    if(valor.match(/˜/)) valor = valor.replace("˜","");
    if(valor.match(/`/)) valor = valor.replace("`","");
    $("input[name=produto_referencia]").val(valor);
    if (document.forms["form1"].elements["paravenda"]) paravenda=$("select[name=paravenda]").val();
    else paravenda=-1;
    if (valor!="") { 
        $.post("entradas_produto_referencia.php", {
            referencia: valor,
            paravenda: paravenda
        }, function(produtos) {
            //alert("Produtos encontrados a partir da referencia:"+produtos);
            //alert(produtos);
            if (produtos=="PRODUTO_SEM_CONTROLE_DE_ESTOQUE") {
                alert ("Este produto está configurado para não ter controle de estoque!");
            } else if (produtos=="PRODUTO_NAO_PARAMETRIZADO_PARA_VENDA") {
                alert ("Este produto não esta parametrizado para ser vendido!");
            } else if (produtos=="PRODUTO_PARAMETRIZADO_PARA_VENDA") {
                alert ("Este produto está parametrizado para ser vendido. E esta entrada está definida aceitar apenas produtos não vendidos!");
            } else {
                produtos2=produtos.split("|");
                produto_codigo=produtos2[0];
                produto_nome=produtos2[1];
                if (produtos!=0) { //Se o produto é valido e uma referencia foi encontrada então popular
                    $("select[name=produto]").html("<option value='"+produto_codigo+"'>"+produto_nome+" </option>");
                    $("input[name=produto2]").val(produto_codigo);
                    valida_produto();            
                } else {
                    $.post("entradas_popula_produto.php", { paravenda: paravenda}, function(valor) {
                        $("select[name=produto]").html(valor);
                        //alert(valor);
                        document.forms["form1"].produto.disabled = false;
                    });
                    valida_produto(); 
                }
            }

        });
    } else {
        $.post("entradas_popula_produto.php", { paravenda: paravenda }, function(valor) {
            $("select[name=produto]").html(valor);
            document.forms["form1"].produto.disabled = false;
        });
    }    

}




function verifica_paravenda () {
    paravenda=$("select[name=paravenda]").val();
    //alert(paravenda);
    if (paravenda==1) {
        $("tr[id=linha_tiponeg]").show();
        $("tr[id=linha_tipopessoa]").show();
        $("tr[id=linha_fornecedor]").show();
        $("select[name=tiponegociacao]").attr("required", true);      
        $("select[name=fornecedor]").attr("required", true);      
    } else {
        $("tr[id=linha_tiponeg]").hide();
        $("tr[id=linha_tipopessoa]").hide();
        $("tr[id=linha_fornecedor]").hide();
        $("select[name=tiponegociacao]").attr("required", false);      
        $("select[name=fornecedor]").attr("required", false);    
    }



}

function mascara_percent() {
        $('#percent').priceFormat({
            prefix: '',
            sufix: '%',
            centsSeparator: ',',
            centsLimit: 2,
            thousandsSeparator: ''
        });    
        $('#percent2').priceFormat({
            prefix: '',
            centsSeparator: ',',
            centsLimit: 2,
            thousandsSeparator: ''
        });    
    
}

function valida_produto() {
    verifica_incluir();

    
    $("input[name=valuni]").val("").priceFormat({prefix: 'R$ ', centsSeparator: ',', thousandsSeparator: '.'});
    $("input[name=valuni]").disabled = true;
    $("input[name=valunicusto]").val("").priceFormat({prefix: 'R$ ', centsSeparator: ',', thousandsSeparator: '.'});
    $("input[name=valunicusto]").disabled = true;
    var temp=document.forms["form1"].percent; if (temp) $("input[name=percent]").disabled = true;
    var temp=document.forms["form1"].percent2; if (temp) $("input[name=percent2]").disabled = true;
    $("input[name=qtd]").val("");
    $("input[name=qtd]").disabled = true;
    $("input[name=validade]").val("");
    $("input[name=validade]").disabled = true;
    $("input[name=validade_item]").disabled = true;
    $("input[name=local]").val("");        
    $("span[name=tipocontagem]").html("");
    $("span[name=qtdtipcon]").html("");
    valunicusto=0;
    $.post("entradas_valorunitario2.php", {
        produto: $("select[name=produto]").val(),
        fornecedor: $("select[name=fornecedor]").val(),
        entrada: $("input[name=entrada2]").val(),
        paravenda: $("select[name=paravenda]").val()
    }, function(valor) {
        //alert(valor);
        if (valor == "naoestanalista") {
            if (document.forms["form1"].elements["valuni"]) document.forms["form1"].valuni.disabled = false;
            document.forms["form1"].validade.disabled = false;
            document.forms["form1"].validade_item.disabled = false;
            //Se o campo está oculto dá pau no javascript a partir o ponto que o sistema não consegue localizar o campo                
            
            if (document.forms["form1"].elements["valunicusto"]) document.forms["form1"].valunicusto.disabled = false;
            desabilita_campos();
            //alert('n�o esta na lista');
            $.post("entradas_valorunitario.php", {
                produto: $("select[name=produto]").val(),
                fornecedor: $("select[name=fornecedor]").val(),
                paravenda: $("select[name=paravenda]").val()
            }, function(valor2) {
                //alert(valor2);
                var quebra = valor2.split("|");
                var valuni = quebra[0];
                var valunicusto = quebra[2];
                if (!valunicusto) valunicusto=0
                $("input[name=valuni]").val(valuni).priceFormat({prefix: 'R$ ', centsSeparator: ',', thousandsSeparator: '.'});
                $("input[name=valuni2]").val(valuni).priceFormat({prefix: '', centsSeparator: ',', thousandsSeparator: '.'});
                $("input[name=validade]").val("");
                $("input[name=validade2]").val("");
                $("input[name=valunicusto]").val(valunicusto).priceFormat({prefix: 'R$ ', centsSeparator: ',', thousandsSeparator: '.'});
                $("input[name=valunicusto2]").val(valunicusto).priceFormat({prefix: '', centsSeparator: ',', thousandsSeparator: '.'});
            });

        } else {
            //alert(valor);
            var quebra = valor.split("|");
            var valuni = quebra[0];
            var validade = quebra[1];
            //alert(validade);
            if (validade == '0000-00-00') {
                validade = "";
            }
            var valunicusto = quebra[2];
            if (!valunicusto) valunicusto=0
            $("input[name=valuni]").val(valuni).priceFormat({prefix: 'R$ ', centsSeparator: ',', thousandsSeparator: '.'});
            $("input[name=valuni2]").val(valuni).priceFormat({prefix: '', centsSeparator: ',', thousandsSeparator: '.'});
            $("input[name=validade]").val(validade);
            $("input[name=validade2]").val(validade);
            $("input[name=valunicusto]").val(valunicusto).priceFormat({prefix: 'R$ ', centsSeparator: ',', thousandsSeparator: '.'});
            $("input[name=valunicusto2]").val(valunicusto).priceFormat({prefix: '', centsSeparator: ',', thousandsSeparator: '.'});

            if (document.forms["form1"].elements["valuni"]) document.forms["form1"].valuni.disabled = true;
            if (document.forms["form1"].elements["valunicusto"]) document.forms["form1"].valunicusto.disabled = true;
            //document.forms["form1"].percent.disabled = true;
            var temp=document.forms["form1"].percent2; if (temp) document.forms["form1"].percent2.disabled = true;                
            document.forms["form1"].validade.disabled = true;
            document.forms["form1"].validade_item.disabled = true;
            //alert('esta na lista');


        }
    });
    $.post("entradas_tipcon.php", {produto: $("select[name=produto]").val()}, function(valor) {
        $("span[name=tipocontagem]").html(valor);
    });


    $.post("entradas_qtdtipcon.php", {produto: $("select[name=produto]").val()}, function(valor) {
        $("span[name=qtdtipcon]").html(valor);
    });

    $("input[name=qtd]").val("");
    desabilita_campos();
}

function desabilita_campos() {
    //alert("entrou");
    var produto = $("select[name=produto]").val();
    var produtocomposto = $("input[name=produtocomposto]").val();
    var paravenda = $("select[name=paravenda]").val();
    //alert(produtocomposto);
    
    //Se tiver um produto composto na lista de itens, não pode mais selecionar um produto, pois só pode ter um produto composto por entrada
    if (produtocomposto==1) {
        document.forms["form1"].marca.disabled = true;
        document.forms["form1"].produto.disabled = true;
        document.forms["form1"].produtomanter.disabled = true;
        $("input[name=produtomanter]").hide(); 
        $("img[id=temprodutocompostoicone]").show(); 
    } else {
        document.forms["form1"].marca.disabled = false;
        document.forms["form1"].produto.disabled = false;
        document.forms["form1"].produtomanter.disabled = false;
        $("input[name=produtomanter]").show(); 
        $("img[id=temprodutocompostoicone]").hide(); 

    }
    
    if (produto != '') { 
        if (document.forms["form1"].qtd) { //se os campos existirem
            document.forms["form1"].qtd.disabled = false;
            if (document.forms["form1"].elements["valuni"]) document.forms["form1"].valuni.disabled = false;
            document.forms["form1"].validade.disabled = false;
            document.forms["form1"].validade_item.disabled = false;
            document.forms["form1"].local.disabled = false;
            document.forms["form1"].valunicusto.disabled = false;
            //document.forms["form1"].percent.disabled = false;
            var temp=document.forms["form1"].percent2; if (temp) document.forms["form1"].percent2.disabled = false;
        }   
        //alert("Habilita");
    }
    else {
        document.forms["form1"].qtd.disabled = true;
        if (document.forms["form1"].elements["valuni"]) document.forms["form1"].valuni.disabled = true;
        document.forms["form1"].validade.disabled = true;
        document.forms["form1"].validade_item.disabled = true;
        document.forms["form1"].validade.value = "";
        document.forms["form1"].local.disabled = true;
        document.forms["form1"].valunicusto.disabled = true;
        //document.forms["form1"].percent.disabled = true;
        var temp=document.forms["form1"].percent2;  if (temp) document.forms["form1"].percent2.disabled = true;
        //alert("desabilitar");            
    }
}

function verifica_incluir() {
    var valoruni = $("input[name=valuni]").val();
    var quant = $("input[name=qtd]").val();
    //alert (quant);
    //alert (valoruni);

    if ((valoruni == "") || (valoruni == 'R$ 0,00') || (valoruni == 'R$ 0,0') || (quant == '0') || (quant == '') || (quant == '0,00')) {
        document.forms["form1"].incluir.disabled = true;
        //alert('desabilita');
    } else {
        if (document.forms["form1"].incluir) {
            document.forms["form1"].incluir.disabled = false;

        }
        //alert('habilita');
    }

}

function popula_validade (dias) {
    
    if (dias==0) {
        $("input[name=validade]").val("");
        $("input[name=validade]").disabled= true;
        $("input[name=validade_item]").disabled= true;

    } else if (dias==-1) {
        $("input[name=validade]").disabled= false;
        $("input[name=validade_item]").disabled= false;
        $("input[name=validade_item]").required= true;
    } else {
        $("input[name=validade]").disabled= true;
        $("input[name=validade_item]").disabled= true;
        var data = new Date(),
        horas = dias*24;
        data.setHours(data.getHours() + horas);
        //var dia=data.getDate();
        //var mes=data.getMonth();
        var dia=('0'+(data.getDate())).slice(-2);
        var mes=('0'+(data.getMonth()+1)).slice(-2);
        var ano=data.getFullYear();
        data = ano + '-' + mes + '-' + dia;
        //alert(data);
        $("input[name=validade]").val(data);
    }
}

function mascara_pesoqtd() {
    $.post("entradas_qtdtipcon.php", {
        produto: $("select[name=produto]").val()
    }, function(valor) {
        $("span[name=qtdtipconcod]").html(valor);
        //alert (valor);
        if (valor == "<b>por un.</b>") {
            $('#qtd').priceFormat({
                prefix: '',
                centsSeparator: '',
                centsLimit: 0,
                thousandsSeparator: '.'
            });
        //alert("qtd");
        } else {
            $('#qtd').priceFormat({
                prefix: '',
                centsSeparator: ',',
                centsLimit: 3,
                thousandsSeparator: '.'
            });
        //alert("peso");
        }
    });
    verifica_incluir();
}

function limpa_item_validade (){
    select_selecionar("validade_item","-1");
}


function popula_produtos_pelamarca(valor) {
    if ($("input[name=tiponegociacao2]").val()) {
        tipneg2 = $("input[name=tiponegociacao2]").val();
    } else {
        tipneg2=0;
    }
    //alert(tipneg2);
    if (document.forms["form1"].elements["paravenda"]) paravenda=$("select[name=paravenda]").val();
    else paravenda=-1;
    if (valor == 'todas') {
        $.post("entradas_popula_produtos_pelamarca2.php", {
            tiponeg: tipneg2,
            paravenda: paravenda
        }, function(valor2) {
            $("select[name=produto]").html(valor2);
        });
    } else {
        $.post("entradas_popula_produtos_pelamarca.php", {
            marca: valor,
            tiponegociacao: tipneg2,
            paravenda:paravenda

        }, function(valor2) {
            //alert(valor2);
            $("select[name=produto]").html(valor2);
        });
    }
}


function calcula_valor_percent() {
    var paravenda=$("select[name=paravenda]").val();
    //alert(paravenda);
    if (paravenda!=0) {

        var custo = $("input[name=valunicusto]").val();
        var venda = $("input[name=valuni]").val();
        custo = custo.replace("R$ ", "");
        custo = custo.replace(".", "");
        custo = custo.replace(",", ".");
        custo = parseFloat(custo);
        venda = venda.replace("R$ ", "");
        venda = venda.replace(".", "");
        venda = venda.replace(",", ".");
        venda = parseFloat(venda);

        //=(venda*100/custo)-100    
        if ((venda != 0)&&(custo!=0))
            percent = (venda * 100 / custo) - 100;
        else
            percent = 0;

        percent = percent.toFixed(2);
        var per = String(percent);
        per = per.replace(".", ",");
        
        //alert(custo2);
        $("input[name=percent2]").val(per);

        if (venda != 0)
            percent2 = -((custo * 100 / venda) - 100);
        else
            percent2 = 0;
        percent2 = percent2.toFixed(2);
        percent2 = percent2.replace(".", ",");
        $("input[name=percent]").val(percent2);

    }

}


</script>

<table summary="" class="tabela1" border="0">
    <tr>
        <td width="35px"><img width="50px" src="{ICONES_CAMINHO}entradas.png" alt="" ></td>
        <td valign="bottom">
            <label class="titulo" > ENTRADAS </label><br />
            <label class="subtitulo"> {SUBTITULO} </label>
        </td>
    </tr>
</table>
<hr align="left" class="linhacurta" >
<br />

<form action="entradas_cadastrar.php" method="post" name="form1">
    <table summary="" border="0" class="tabela1" cellpadding="4">
       <input type="hidden" name="controlavalidade" value="{CONTROLAVALIDADE}">
       <input type="hidden" name="usaprateleira" value="{USAPRATELEIRA}">
        

        <!--  BEGIN BLOCK_SELECT_ENTRADA -->
        <tr>
            <td class="fun" align="right" width="200px"><b>Entrada:<label class="obrigatorio"></label></b></td>
            <td class="fundo1" ><input type="text" size="8" required name="entrada_codigo" class="campopadrao" disabled value="{ENTRADA}"> </td>
        </tr>
        <!--  END BLOCK_SELECT_ENTRADA -->

        <!--  BEGIN BLOCK_DATAHORA -->
        <tr>
            <td align="right"  width="200px"><b>Data: <label class="obrigatorio"></label></b></td>
            <td class="fundo1" >
                <input 
                    type="date" 
                    size="" style="width: 150px;" 
                    required 
                    name="data1" 
                    class="campopadrao"  
                    value="{ENTRADAS_DATA}" 
                    <!--  BEGIN BLOCK_DATA_DESABILITADA -->
                     disabled 
                    <!--  END BLOCK_DATA_DESABILITADA -->
                    
                >
            </td>
        </tr>    
        <tr>
            <td align="right"><b>Hora: <label class="obrigatorio"></label></b></td>
            <td class="fundo1" >
                <input 
                    type="time" 
                    size="" required 
                    name="hora1" 
                    class="campopadrao"  
                    value="{ENTRADAS_HORA}"
                    <!--  BEGIN BLOCK_HORA_DESABILITADA -->
                     disabled 
                    <!--  END BLOCK_HORA_DESABILITADA -->
                >
            </td>
        </tr> 
        <!--  END BLOCK_DATAHORA --> 
 
        <!--  BEGIN BLOCK_SELECT_PARAVENDA -->
        <tr id="linha_paravenda">
            <td align="right"><b>Produtos serão vendidos? <label class="obrigatorio"></label></b></td>
            <td class="fundo1" >
                <select autofocus="1" name="paravenda" onchange="verifica_paravenda();" class="campopadrao campo_tamanho_6" {SELECT_PARAVENDA_OBRIGATORIO} {SELECT_PARAVENDA_DESABILITADO} >
                    <option value="0" {PARAVENDA_NAO_SELECIONADO}>Não</option> 
                
                    <option value="1" {PARAVENDA_SIM_SELECIONADO}>Sim</option> 
 
                </select>
                 <input type="hidden" name="paravenda2" value="{PARAVENDA}">
            </td>            
        </tr>


        <!--  END BLOCK_SELECT_PARAVENDA -->  


        <!--  BEGIN BLOCK_SELECT_TIPONEGOCIACAO -->
        <tr id="linha_tiponeg">
            <td align="right" width="200px"><b>Tipo de Negociação: <label class="obrigatorio"></label></b></td>
            <td class="fundo1" >
                <select autofocus="1" name="tiponegociacao" onchange="popula_tipopessoa(this.value);" class="campopadrao campo_tamanho_6" {SELECT_OBRIGATORIO} {SELECT_DESABILITADO} >
                    <option value="">Selecione</option>	
                    <!--  BEGIN BLOCK_OPTIONS_TIPONEGOCIACAO -->
                    <option value="{OPTION_VALOR}" {OPTION_SELECIONADO} >{OPTION_TEXTO}</option>
                    <!--  END BLOCK_OPTIONS_TIPONEGOCIACAO -->
                </select>
                <input type="hidden" name="tiponegociacao2" value="{TIPONEGOCIACAO}">
            </td>            
        </tr>
        <!--  END BLOCK_SELECT_TIPONEGOCIACAO -->        


        <!--  BEGIN BLOCK_SELECT_TIPOPESSOA -->
        <tr id="linha_tipopessoa">
            <td align="right" width="200px"><b>Tipo de Pessoa: <label class="obrigatorio"></label></b></td>
            <td class="fundo1" >
                <select autofocus="" name="tipopessoa" class="campopadrao campo_tamanho_6" {SELECT_TIPOPESSOA_OBRIGATORIO} {SELECT_TIPOPESSOA_DESABILITADO} onchange="popula_fornecedores2(this.value);">
                    <!-- BEGIN BLOCK_OPTIONPADRAO -->
                    <option value="">Todos</option>	
                    <!-- END BLOCK_OPTIONPADRAO -->
                    <!-- BEGIN BLOCK_OPTIONPADRAO2 -->
                    <option value=""></option>	
                    <!-- END BLOCK_OPTIONPADRAO2 -->
                    <!--  BEGIN BLOCK_OPTIONS_TIPOPESSOA -->
                    <option value="{OPTION_TIPOPESSOA_VALOR}" {OPTION_TIPOPESSOA_SELECIONADO} >{OPTION_TIPOPESSOA_TEXTO}</option>
                    <!--  END BLOCK_OPTIONS_TIPOPESSOA -->
                </select>
                <input type="hidden" name="tipopessoa2" value="{TIPOPESSOA}">
            </td>            
        </tr>
        <!--  END BLOCK_SELECT_TIPOPESSOA -->
        <!--  BEGIN BLOCK_SELECT_FORNECEDOR -->
        <tr id="linha_fornecedor">
            <td align="right" width="200px"><b>Fornecedor: <label class="obrigatorio"></label></b></td>
            <td class="fundo1" >
                <select autofocus="1" name="fornecedor" class="campopadrao campo_tamanho_6" {SELECT_OBRIGATORIO} {SELECT_DESABILITADO} >
                    <option value=""></option>	
                    <!--  BEGIN BLOCK_OPTIONS_FORNECEDOR -->
                    <option value="{OPTION_VALOR}" {OPTION_SELECIONADO} >{OPTION_TEXTO}</option>
                    <!--  END BLOCK_OPTIONS_FORNECEDOR -->
                </select>
                <input type="hidden" name="fornecedor2" value="{FORNECEDOR}">
            </td>            
        </tr>
        <!--  END BLOCK_SELECT_FORNECEDOR -->
        <!--  BEGIN BLOCK_SUPERVISOR -->
        <tr>
            <td align="right" width="200px"><b>Supervisor: <label class="obrigatorio"></label></b></td>
            <td class="fundo1" >
                <select autofocus="1" name="supervisor" class="campopadrao campo_tamanho_6"  {SELECT_OBRIGATORIO} {SELECT_DESABILITADO} >
                    <option value="">Selecione</option>	
                    <!--  BEGIN BLOCK_OPTIONS_SUPERVISOR -->
                    <option value="{OPTION_VALOR}" {OPTION_SELECIONADO} >{OPTION_TEXTO}</option>
                    <!--  END BLOCK_OPTIONS_SUPERVISOR -->
                </select>                
            </td>

        </tr>
        <!--  END BLOCK_SUPERVISOR -->      




        <!--  BEGIN BLOCK_BOTAO_PASSO1 -->
        <tr>
            <td>&nbsp;</td>
            <td class="fundo1" >
                <input type="hidden" name="passo" value="2">
                <input type="submit" value="CONTINUAR" class="botao fonte3">
            </td>
        </tr>
        <!--  END BLOCK_BOTAO_PASSO1 -->

        <!-- Ap�s a gera��o da entrada � necess�rio enviar o codigo da entrada novamente para o php   -->
        <input type="hidden" name="entrada" value="{ENTRADA}">

        <!--  BEGIN BLOCK_PASSO2 -->
        <tr>
            <td align="right" width="200px"><b>Marca: <label class="obrigatorio"></label></b></td>
            <td class="fundo1" >
                <select name="marca" onchange="popula_produtos_pelamarca(this.value);" id="marca" class="campopadrao campo_tamanho_6" {SELECT_MARCA_OBRIGATORIO} {SELECT_MARCA_DESABILITADO} >
                    <option value="todas">Todas</option>	
                    <!--  BEGIN BLOCK_OPTIONS_MARCA -->
                    <option value="{OPTION_MARCA_VALOR}" {OPTION_MARCA_SELECIONADO} >{OPTION_MARCA_TEXTO}</option>
                    <!--  END BLOCK_OPTIONS_MARCA -->
                </select>
            </td>
        </tr>
        <tr>
            <td align="right" width="200px"><b>Produto: <label class="obrigatorio"></label></b></td>
            
            <td class="fundo1" >
                <input type="text" name="produto_referencia" value="" class="campopadrao campo_tamanho_4 " onkeyup="seleciona_produto(this.value); " size="" align="left">  
                <select autofocus="2" name="produto" style="width: 250px" onchange=" valida_produto()"   id="{SELECT2_NOME}" class="campopadrao campo_tamanho_6" {SELECT2_OBRIGATORIO} {SELECT2_DESABILITADO} >
                    <option value="">Selecione</option>	
                    <!--  BEGIN BLOCK_OPTIONS_PRODUTO -->
                    <option value="{OPTION2_VALOR}" {OPTION2_SELECIONADO} >{OPTION2_TEXTO}</option>
                    <!--  END BLOCK_OPTIONS_PRODUTO -->
                </select>
                <input type="hidden" name="produto2" value="{PRODUTO2}">
                <input type="checkbox" name="produtomanter" {PRODUTOMANTER_HABILITADO} class="css-checkbox" id="checkbox4"  title="Manter o produto selecionado"><span></span>
                <img  width="15px" name="temprodutocompostoicone" id="temprodutocompostoicone" src="../imagens/icones/geral/atencao.png"  title="Informação" alt="Informação" />
                <a class="link" href="#"><img id="atualizar_produto" src="../imagens/icones/geral/atualizar.png" width="12px" onclick="atualiza_produtos_cadastro_direto()"></a>
                <a href="produtos_cadastrar.php?modal=1&operacao=cadastrar" target="_blank" class="link">
                    <img id="atualizar_produto" src="../imagens/icones/geral/add.png" width="12px">
                </a> 
                
                
            </td>
        </tr>
        <tr>
            <td align="right"><b>Quantidade: <label class="obrigatorio"></label></b></td>
            <td class="fundo1"> <input type="text" size="6" required  name="qtd" id="qtd" onclick="this.select()"  onkeyup="mascara_pesoqtd()" class="campopadrao campo_tamanho_3 campo_qtd" autocomplete="off" >&nbsp;<span name="tipocontagem" class="dicacampo"></span></td>
        </tr>
        <!--  BEGIN BLOCK_CAMPO_VALCUSTO -->
        <tr>
            <td align="right"><b>Valor Unitário Custo: <label class="obrigatorio"></label></b></td>
            <td class="fundo1" >
                <input type="text" size="8" style="width: 100px;" {VALUNI_OBRIGATORIO}  name="valunicusto" class="campopadrao campo_tamanho_3 campo_qtd" autocomplete="off" onclick="this.select()" onkeyup="" onblur="calcula_valor_percent(); ">&nbsp;    
                <!-- <span name="qtdtipcon" class="dicacampo" autocomplete="off" ></span> -->
                <input id="percent2" name="percent2" type="text" value="" class="campopadrao campo_tamanho_2  campo_qtd" size="5" onblur="calcula_valor_venda();" onkeyup="mascara_percent();" onclick="this.select()" tabindex="-1">
                <span name="" class="dicacampo" autocomplete="off" >%</span>            
            </td>
        </tr>
        <!--  END BLOCK_CAMPO_VALCUSTO -->
        <!--  BEGIN BLOCK_CAMPO_VALVENDA -->
        <tr>
            <td align="right"><b>Valor Unitário Venda: <label class="obrigatorio"></label></b></td>
            <td class="fundo1" >
                <input type="text" size="10" style="width: 100px;" required  name="valuni" class="campopadrao campo_tamanho_3  campo_qtd" autocomplete="off" onclick="this.select()" onkeyup="verifica_incluir();" onblur="calcula_valor_percent(); ">&nbsp;
                <!-- <span name="qtdtipcon" class="dicacampo" autocomplete="off" ></span> -->
                <!--  BEGIN BLOCK_PERCENT -->
                <input id="percent" name="percent" type="text" value="" class="campopadrao campo_tamanho_2  campo_qtd" size="5" onblur="//calcula_valor_unitario();" onkeyup="mascara_percent();"  onclick="this.select()" disabled="disabled" a="aa">
                <span name="" class="dicacampo" autocomplete="off" >%</span>
                <!--  END BLOCK_PERCENT -->
            </td>
        </tr>
        <!--  END BLOCK_CAMPO_VALVENDA -->
        <tr id="linha_validade">
            <td align="right"><b>Validade: <label class="obrigatorio"></label></b></td>
            <td class="fundo1" >
                <select class="campopadrao" name="validade_item" id="validade_item"  onchange="popula_validade(this.value);">
                    <option value="0" >Sem validade</option>
                    <option value="1">1 dia</option>
                    <option value="2">2 dias</option>
                    <option value="3">3 dias</option>
                    <option value="5">5 dias</option>
                    <option value="7">7 dias</option>
                    <option value="10">10 dias</option>
                    <option value="15">15 dias</option>
                    <option value="20">20 dias</option>
                    <option value="30">30 dias</option>
                    <option value="45">45 dias</option>
                    <option value="60">60 dias</option>
                    <option value="90">90 dias</option>
                    <option value="180" >180 dias</option>
                    <option value="360">360 dias</option>
                    <option value="-1">Pré-definida</option>
                </select>
                <input type="date" size="" maxlength="" max="{VALIDADE_MAX}" min="{VALIDADE_MIN}" name="validade" id="validade" class="campopadrao campo_tamanho_5"  onclick="" onblur="calcula_saldovalidade(this.value); limpa_item_validade();" disabled="true">
                <span name="saldovalidade" id="saldovalidade" class="dicacampo" ></span>
            </td>
        </tr>
        <tr id="linha_prateleira">
            <td align="right"><b>Local/Prateleira: <label class="obrigatorio"></label></b></td>
            <td class="fundo1" ><input type="text" size="25" maxlength="" name="local" id="local" class="campopadrao campo_tamanho_6"  onclick="this.select()" >
        </tr>

        <!--  BEGIN BLOCK_BOTAO_PASSO2 -->
        <tr>
            <td>&nbsp;</td>
            <td  class="" >
                <input type="hidden" name="passo" value="3">
                <input type="submit" id="incluir" name="incluir" value="INCLUIR PRODUTO" class="botao fonte3" >
            </td>
        </tr>
        <!--  END BLOCK_BOTAO_PASSO2 -->
        <!--  END BLOCK_PASSO2 -->
    </table>

    <!--  BEGIN BLOCK_ENTER -->
    </br>
    <!--  END BLOCK_ENTER -->

    <!-- Este campo oculto é necessário para desabilitar os selects  marca e produto quando o usuário ja tiver incluído um produto composto na lista, pois só pode ter um produto composto por entrada!   -->
    <input type="hidden" name="produtocomposto" value="{PRODUTOCOMPOSTO}">

    <!--  BEGIN BLOCK_PASSO3 -->
    <table border="1" class="tabela1" cellpadding="4" width="100%">
        <tr valign="middle" class="tabelacabecalho1">
            <td width="">Nº</td>
            <td width="330px" colspan="2">PRODUTO</td>
            <td width="100px" align="center" colspan="2">QUANTIDADE</td>	
            <!-- BEGIN BLOCK_CUSTO_CABECALHO -->
            <td width="" align="center">VALOR UNIT. CUSTO</td>          
            <td width="" align="center">VALOR TOT. CUSTO</td>
            <!-- END BLOCK_CUSTO_CABECALHO -->
            <!-- BEGIN BLOCK_VENDA_VALUNI_CABECALHO -->
            <td width="" align="center">VALOR UNIT. VENDA</td>          
            <!-- END BLOCK_VENDA_VALUNI_CABECALHO -->
            <!-- BEGIN BLOCK_VENDA_CABECALHO -->            
             <!-- <td width="" align="center">VALOR TOT. VENDA</td>  -->        
            <!-- END BLOCK_VENDA_CABECALHO -->            
            <!-- BEGIN BLOCK_LUCRO_CABECALHO -->
            <td width="" align="center">LUCRO TOT. PREVISTO</td> 
            <!-- END BLOCK_LUCRO_CABECALHO -->
            <td width="" align="center">VALIDADE</td> 
            <!-- BEGIN BLOCK_SUBPRODUTOS_CABECALHO -->
            <td width="" align="center" colspan="3">SUB-PRODUTOS</td> 
            <!-- END BLOCK_SUBPRODUTOS_CABECALHO -->
            <!--  BEGIN BLOCK_CABECALHO_OPERACAO -->
            <td width="70px" colspan="{OPER_COLSPAN}">OPER.</td>
            <!--  END BLOCK_CABECALHO_OPERACAO -->
        </tr>

        <!--  BEGIN BLOCK_LISTA -->
        <tr class="lin">
            <td>{ENTRADAS_NUMERO}</td>
            <td align="right" width="80px">{ENTRADAS_PRODUTO}</td>
            <td>{ENTRADAS_PRODUTO_NOME}</td>
            <td align="right">{ENTRADAS_QTD}</td>
            <td align="left">{SIGLA}</td>
            <!-- BEGIN BLOCK_CUSTO -->
            <td align="right">{ENTRADAS_VALORUNI_CUSTO}</td>
            <td align="right">{ENTRADAS_VALOR_TOTAL_CUSTO}</td>
            <!-- END BLOCK_CUSTO -->
            <!-- BEGIN BLOCK_VENDA_VALUNI -->
            <td align="right">{ENTRADAS_VALORUNI}</td>    
            <!-- END BLOCK_VENDA_VALUNI -->
            <!-- BEGIN BLOCK_VENDA -->
             <!-- <td align="right">{ENTRADAS_VENDA_TOTAL}</td> -->                    
            <!-- END BLOCK_VENDA -->
            <td align="right">{ENTRADAS_VALIDADE}</td>
            
            <!-- BEGIN BLOCK_SUBPRODUTOS_MOSTRAR -->
            <td align="right">
            <!-- BEGIN BLOCK_SUBPRODUTOS_TEM -->
                <img  width="15px"  src="../imagens/icones/geral/{NOMEARQUIVO}"  title="{TITULO}" alt="{TITULO}" />
            <!-- END BLOCK_SUBPRODUTOS_TEM -->
            </td>
            <td align="{SUBPRODUTOS_ALINHAMENTO}" colspan="{SUBPRODUTOS_COLSPAN}">
            <!-- BEGIN BLOCK_SUBPRODUTOS -->
                <img  width="15px"  src="../imagens/icones/geral/{SUBPRODUTOS_NOMEICONEARQUIVO}"  title="{SUBPRODUTOS_TITULO}" alt="{SUBPRODUTOS_TITULO}" />
            <!-- END BLOCK_SUBPRODUTOS -->
            </td>
            <!-- BEGIN BLOCK_SUBPRODUTOS_VER -->
            <td align="left">
                <a href="#" target="_blank" class="link1">
                    <img  width="15px"  src="../imagens/icones/geral/{SUBPRODUTOS_NOMEICONEARQUIVO_VER}"  title="Ver Sub-produtos" alt="Ver" />
                </a>
            </td>
            <!-- END BLOCK_SUBPRODUTOS_VER -->
            <!-- END BLOCK_SUBPRODUTOS_MOSTRAR -->
            
            <!-- BEGIN BLOCK_LUCRO -->
            <td align="right">{ENTRADAS_VALOR_LUCRO}</td>
            <!-- END BLOCK_LUCRO -->
            <!--  BEGIN BLOCK_LISTA_OPERACAO -->
            <!--  BEGIN BLOCK_LISTA_OPERACAO_ETIQUETAS -->
            <td align="center" class="fundo1"> 
                <a href="{IMPRIMIR_LINK}" target="_blank" class="link1">
                    <img  width="15px"  src="{IMPRIMIR}"  title="Imprimir Etiqueta" alt="Imprimir Etiqueta" />
                </a>
            </td>
            <!--  END BLOCK_LISTA_OPERACAO_ETIQUETAS -->
            <!--  BEGIN BLOCK_LISTA_OPERACAO_EXCLUIR -->
            <td align="center" class="fundo1">
                <!--  BEGIN BLOCK_LISTA_OPERACAO_EXCLUIR_LINK -->
                <a href="entradas_cadastrar.php?fornecedor={FORNECEDOR}&cancelar=1&passo=3&entrada={ENTRADA}&produto={PRODUTO}&item_numero={ENTRADAS_NUMERO}&tiponegociacao={TIPONEGOCIACAO}&paravenda2={PARAVENDA}" class="link1">
                <!--  END BLOCK_LISTA_OPERACAO_EXCLUIR_LINK -->                    
                    <img  width="15px" src="{ICONES_CAMINHO}{ICONES_ARQUIVO}"  title="{ICONES_TITULO}" alt="Remover" />
                </a>
            </td>
            <!--  END BLOCK_LISTA_OPERACAO_EXCLUIR -->

            <!--  BEGIN BLOCK_LISTA_OPERACAO_VERVENDAS -->
            <td align="center" class="fundo1">
                <a href="saidas.php?filtro_produto={VERVENDAS_PRODUTO}&filtro_lote={VERVENDAS_LOTE}" class="link1">
                    <img  width="15px" src="{ICONES_CAMINHO}{ICONES_ARQUIVO}"  title="{ICONES_TITULO}" alt="Remover" />
                </a>
            </td>
            <!--  END BLOCK_LISTA_OPERACAO_VERVENDAS -->

            <!--  END BLOCK_LISTA_OPERACAO -->        
        </tr>
        <!--  END BLOCK_LISTA -->

        <!--  BEGIN BLOCK_LISTA_NADA -->
        <tr>
            <td colspan="12" align="center" class="errado">
                Nenhum produto na lista!
            </td>
        </tr>
        <!--  END BLOCK_LISTA_NADA -->
        <tr class="tabelarodape1">
            <td> </td>
            <td> </td>
            <td> </td>
            <td> </td>
            <td> </td>
            <!-- BEGIN BLOCK_CUSTO_RODAPE -->
            <td align="right"></td>
            <td align="right">{TOTAL_CUSTO}</td>
            <!-- END BLOCK_CUSTO_RODAPE -->
            <!-- BEGIN BLOCK_VENDA_VALUNI_RODAPE -->
            <td> </td>            
            <!-- END BLOCK_VENDA_VALUNI_RODAPE -->
            <!-- BEGIN BLOCK_VENDA_RODAPE -->
            <td align="right">{TOTAL_VENDA}</td>
            <!-- END BLOCK_VENDA_RODAPE -->
            <!-- BEGIN BLOCK_LUCRO_RODAPE -->
            <td align="right">{TOTAL_LUCRO}</td>
            <!-- END BLOCK_LUCRO_RODAPE -->
            <td> </td>
            <!--  BEGIN BLOCK_SUBPRODUTOS_RODAPE -->            
            <td colspan="3"></td>
            <!--  END BLOCK_SUBPRODUTOS_RODAPE -->            
            <!--  BEGIN BLOCK_LISTA_NADA_OPERACAO -->            
            <td> </td>
            <!--  END BLOCK_LISTA_NADA_OPERACAO -->
        </tr>

    </table>
    <br>

    <!-- BEGIN BLOCK_HR -->
    <hr >
    <!-- END BLOCK_HR -->

    <input type="hidden" name="entrada2" value="{ENTRADA}">
    <!-- este valor � alimentado pelo javascript, � necess�rio para quando h� mais de um produto na lista de produtos porque o campo fica desabilitado-->
    <input type="hidden" name="valuni2" id="valuni2" value="">
    <input type="hidden" name="valunicusto2" id="valunicusto2" value="">
    <input type="hidden" name="validade2" id="validade2" value="">
    <input type="hidden" name="temsubprodutos" id="temsubprodutos" value="">

    
    <!-- BEGIN BLOCK_BOTOES -->
    <input type="hidden" name="subproduto_incluso" id="subproduto_incluso" value="{SUBPRODUTO_INCLUSO}">
    <table border="0">
        <tr class="">
            <td width="100%" align="left">
                <!-- BEGIN BLOCK_BOTOES_EXCLUIR_LINK -->
                <a class="link" href="entradas_cancelar.php?codigo={ENTRADA}">
                <!-- END BLOCK_BOTOES_EXCLUIR_LINK -->
                <input type="button" class="botao fonte3 {EXCLUIR_CLASSE}" value="ELIMINAR ENTRADA" {ELIMINAR_ENTRADA_DESABILITADO} title="{EXCLUIR_TITULO}">
                </a>    
            </td>
            <td>
                <a class="link" target="_blank" href="entradas_etiquetas_massa.php?lote={ENTRADA}">
                    <input type="button" class="botao fonte3" value="IMPRIMIR TODAS ETIQUETAS">
                </a>        
            </td>
            <td>
                <a class="link" href="entradas.php" target="">
                    <input type="button" class="botao fonte3" value="{INTERROMPER}">
                </a>        
            </td>
            <td>
                <a class="link" href="entradas_cadastrar2.php?salvar=1&entrada={ENTRADA}&operacao={OPERACAO}&passo=1">
                    <input type="button" 
                           {SALVAR_DESABILIDADO}
                           class="botao fonte3 botaopadraocadastrar"
                           value="CONTINUAR"
                           >
                </a>
            </td>
        </tr>
    </table>
    <!-- END BLOCK_BOTOES -->


    <!-- BEGIN BLOCK_BOTAO_VOLTAR -->
    <a class="link" href="javascript:window.history.go(-1)"><input type="button" value="VOLTAR" class="botao fonte3" autofocus="1"></a>    
    <!-- END BLOCK_BOTAO_VOLTAR -->

    <!-- BEGIN BLOCK_BOTAO_FECHAR -->
    <a class="link" href="javascript:window.close(0);"><input type="button" value="FECHAR" class="botao fonte3" autofocus="1"></a>    
    <!-- END BLOCK_BOTAO_FECHAR -->

    <!-- BEGIN BLOCK_BOTAO_IMPRIMIR -->
    <a class="link" href="entradas_imprimir.php?codigo={ENTRADA}&tipo=1" target="_blank">
        <input type="button" value="IMPRIMIR" class="botao fonte3">
    </a>    
    <!-- END BLOCK_BOTAO_IMPRIMIR -->

    <!-- BEGIN BLOCK_BOTAO_IMPRIMIR_CUSTO -->
    <a class="link" href="entradas_imprimir.php?codigo={ENTRADA}&tipo=2" target="_blank">
        <input type="button" value="IMPRIMIR CUPOM REVENDA" class="botao fonte3">
    </a>    
    <!-- END BLOCK_BOTAO_IMPRIMIR_CUSTO -->




    <!--  END BLOCK_PASSO3 -->


</form>

